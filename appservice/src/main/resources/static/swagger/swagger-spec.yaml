swagger: '2.0'
info:
  title: Yona app service API
  description: The API of the service backing the Yona app
  version: 1.0.0
schemes:
  - https
  - http
basePath: /
produces:
  - application/json
paths:
  /users/:
    post:
      summary: Add a new user
      description: Registers a new user
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: false
          type: string
        - name: overwriteUserConfirmationCode
          in: query
          description: Pass the confirmation code here when trying to overwrite the account in case of a device loss
          required: false
          type: string
        - in: body
          name: body
          description: New user
          required: true
          schema:
            $ref: '#/definitions/PostPutUser'
      tags:
        - User
      responses:
        '201':
          description: The created user
          schema:
            $ref: '#/definitions/UserWithPrivateData'
        default:
          description: Unexpected error.
          schema:
            $ref: '#/definitions/ConfirmationError'
  '/users/{userID}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
    get:
      summary: Get a user
      description: Fetches the user identified by the given ID
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: false
          type: string
        - name: tempPassword
          in: query
          description: The temporary password that was included in the invitation e-mail when a user invited a non-Yona user as buddy
          required: false
          type: string
        - name: includePrivateData
          in: query
          description: Pass true to fetch the private data of the user
          required: false
          type: boolean
      tags:
        - User
      responses:
        '200':
          description: The requested user. The set of returned properties depends on the query parameter includePrivateData.
          schema:
            $ref: '#/definitions/UserWithPrivateData'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    put:
      summary: Update a user
      description: Fetches the user identified by the given ID
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
        - name: tempPassword
          in: query
          description: The temporary password that was included in the invitation e-mail when a user invited a non-Yona user as buddy
          required: false
          type: string
        - in: body
          name: body
          description: New user
          required: true
          schema:
            $ref: '#/definitions/PostPutUser'
      tags:
        - User
      responses:
        '200':
          description: The updated user
          schema:
            $ref: '#/definitions/UserWithPrivateData'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    delete:
      summary: Delete a user
      description: Deletes the user with the given ID
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
        - name: message
          in: query
          description: A message of the user to their buddies, explaining why they unsubscribe from Yona
          required: false
          type: string
      tags:
        - User
      responses:
        '200':
          description: The user is deleted.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/confirmMobileNumber':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    post:
      summary: Confirm mobile number
      description: Post the code to confirm the mobile number of the user. This number is sent to the user by SMS.
      parameters:
        - in: body
          name: body
          description: Message with confirmation code
          required: true
          schema:
            $ref: '#/definitions/ConfirmationCode'
      tags:
        - User
      responses:
        '201':
          description: The updated user
          schema:
            $ref: '#/definitions/UserWithPrivateData'
        default:
          description: Confirmation failed
          schema:
            $ref: '#/definitions/ConfirmationError'
  '/users/{userID}/resendMobileNumberConfirmationCode':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    post:
      summary: Request resend of a mobile number confirmation code
      description: Post an empty request to get a new mobile number confirmation code texted to the user
      tags:
        - User
      responses:
        '200':
          description: The request is successfully handled
        default:
          description: Confirmation failed
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/openApp':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    post:
      summary: Inform the server that the user just opened the Yona app
      description: The server uses this to maintain the "last seen" information
      tags:
        - User
      responses:
        '200':
          description: The request is successfully handled
        default:
          description: Action failed
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/apple.mobileconfig':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get the Apple mobile config for this user
      description: Fetches the user-specific .mobileconfig file needed for iOS devices. Notice this contains VPN username and password.
      tags:
        - User
      responses:
        '200':
          description: The config file
          schema:
            type: file
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'           
  '/users/{userID}/goals/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    post:
      summary: Add a new goal
      description: Add a new goal to an existing user
      parameters:
        - name: message
          in: query
          description: A text message that will be sent to buddies to inform them about the new goal
          required: false
          type: string
        - in: body
          name: body
          description: New goal
          required: true
          schema:
            $ref: '#/definitions/PostPutGoal'
      tags:
        - Goal
      responses:
        '201':
          description: The created goal
          schema:
            $ref: '#/definitions/Goal'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    get:
      summary: Get all goals
      description: Fetches all goals of the user with the given ID
      tags:
        - Goal
      responses:
        '200':
          description: All goals of this user.
          schema:
            type: array
            items:
              $ref: '#/definitions/Goal'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/goals/{goalID}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: goalID
        in: path
        description: The ID of the goal
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get a goal
      description: Fetches the goal identified by the given ID
      tags:
        - Goal
      responses:
        '200':
          description: The requested goal.
          schema:
            $ref: '#/definitions/Goal'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    put:
      summary: Update a goal
      description: Update an existing goal
      parameters:
        - name: message
          in: query
          description: A text message that will be sent to buddies to inform them about the goal change
          required: false
          type: string
        - in: body
          name: body
          description: Updated goal
          required: true
          schema:
            $ref: '#/definitions/PostPutGoal'
      tags:
        - Goal
      responses:
        '200':
          description: The updated goal
          schema:
            $ref: '#/definitions/Goal'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    delete:
      summary: Delete goal
      description: Deletes this goal
      parameters:
        - name: message
          in: query
          description: A text message that will be sent to buddies to inform them about the deletion of the goal
          required: false
          type: string
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
      tags:
        - Goal
      responses:
        '200':
          description: The goal is deleted.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/appActivity/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    post:
      summary: Report app activities
      description: Reports the usage of apps on the device
      parameters:
        - in: body
          name: body
          description: The app activity report
          required: true
          schema:
            type: object
            properties:
              deviceDateTime:
                type: string
                format: dateTime
                description: The actual time on the device
                example: 2016-02-31T21:03:52.290+0000
              activities:
                type: array
                description: A set of app activities
                items:
                  type: object
                  properties:
                    application:
                      type: string
                      description: The name of the app
                      example: Facebook
                    startTime:
                      type: string
                      format: dateTime
                      description: The time the app was activiated
                      example: 2016-02-31T21:03:52.290+0000
                    endTime:
                      type: string
                      format: dateTime
                      description: The time the app was deactiviated
                      example: 2016-02-31T21:28:02.290+0000
                  required:
                    - application
                    - startTime
                    - endTime
            required:
              - deviceDateTime
              - activities
      tags:
        - App activity
      responses:
        '200':
          description: App activity reported correctly
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/activity/days/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get day activity overview
      description: Get network and app activity of the current day, pageable to yesterday and before
      parameters:
        - name: size
          in: query
          description: The number of elements to be fetched
          required: false
          default: 3
          type: number
        - name: page
          in: query
          description: The page to be fetched
          required: false
          default: 0
          type: number
      tags:
        - Activity
      responses:
        '200':
          description: Activity of this user.
          schema:
            $ref: '#/definitions/PagedDayActivityOverviews'
  '/users/{userID}/activity/days/{date}/details/{goalID}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: date
        in: path
        description: The date of the day in ISO 8601 format (yyyy-MM-dd)
        required: true
        type: string
      - name: goalID
        in: path
        description: The ID of the goal for which the activity was recorded
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get day activity detail
      description: Get day network and app activity for a specific goal on a specific day
      tags:
        - Activity
      responses:
        '200':
          description: Activity of this user for the specific goal on the specific day.
          schema:
            $ref: '#/definitions/DayGoalActivityDetail'
  '/users/{userID}/activity/days/{date}/details/{goalID}/messages/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: date
        in: path
        description: The date of the day in ISO 8601 format (yyyy-MM-dd)
        required: true
        type: string
      - name: goalID
        in: path
        description: The ID of the goal for which the activity was recorded
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get messages
      description: Fetches all messages related to this activity
      parameters:
        - name: size
          in: query
          description: The number of elements to be fetched
          required: false
          default: 3
          type: number
        - name: page
          in: query
          description: The page to be fetched
          required: false
          default: 0
          type: number
      tags:
        - Activity
        - Message
      responses:
        '200':
          description: Messages related to this activity.
          schema:
            $ref: '#/definitions/PagedMessages'
  '/users/{userID}/activity/weeks/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get week activity overview
      description: Get network and app activity of the current week, pageable to the weeks before
      parameters:
        - name: size
          in: query
          description: The number of elements to be fetched
          required: false
          default: 2
          type: number
        - name: page
          in: query
          description: The page to be fetched
          required: false
          default: 0
          type: number
      tags:
        - Activity
      responses:
        '200':
          description: Activity of this user.
          schema:
            $ref: '#/definitions/PagedWeekActivityOverviews'
  '/users/{userID}/activity/weeks/{week}/details/{goalID}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: week
        in: path
        description: The date of the week in ISO 8601 format (YYYY-'W'w)
        required: true
        type: string
      - name: goalID
        in: path
        description: The ID of the goal for which the activity was recorded
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get week activity detail
      description: Get day network and app activity for a specific goal on a specific week
      tags:
        - Activity
      responses:
        '200':
          description: Activity of this user for the specific goal on the specific week.
          schema:
            $ref: '#/definitions/WeekGoalActivityDetail'
  '/users/{userID}/activity/withBuddies/days/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get day activity overview of user with buddies
      description: Get network and app activity of the current day of this user and their buddies, pageable to yesterday and before
      parameters:
        - name: size
          in: query
          description: The number of elements to be fetched
          required: false
          default: 3
          type: number
        - name: page
          in: query
          description: The page to be fetched
          required: false
          default: 0
          type: number
      tags:
        - Activity
      responses:
        '200':
          description: Activity of this user and their buddies.
          schema:
            $ref: '#/definitions/PagedDayActivityOverviewsWithBuddies'
  '/users/{userID}/activity/weeks/{week}/details/{goalID}/messages/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: week
        in: path
        description: The date of the week in ISO 8601 format (YYYY-'W'ww)
        required: true
        type: string
      - name: goalID
        in: path
        description: The ID of the goal for which the activity was recorded
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get messages
      description: Fetches all messages related to this activity
      parameters:
        - name: size
          in: query
          description: The number of elements to be fetched
          required: false
          default: 3
          type: number
        - name: page
          in: query
          description: The page to be fetched
          required: false
          default: 0
          type: number
      tags:
        - Activity
        - Message
      responses:
        '200':
          description: Messages related to this activity.
          schema:
            $ref: '#/definitions/PagedMessages'
  '/users/{userID}/buddies/{buddyID}/activity/days/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: buddyID
        in: path
        description: The ID of the buddy
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get day activity overview
      description: Get network and app activity of the current day, pageable to yesterday and before
      parameters:
        - name: size
          in: query
          description: The number of elements to be fetched
          required: false
          default: 3
          type: number
        - name: page
          in: query
          description: The page to be fetched
          required: false
          default: 0
          type: number
      tags:
        - Activity
      responses:
        '200':
          description: Activity of the buddy.
          schema:
            $ref: '#/definitions/PagedDayActivityOverviews'
  '/users/{userID}/buddies/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    post:
      summary: Add a new buddy
      description: Add a new buddy to an existing user
      parameters:
        - in: body
          name: body
          description: New buddy
          required: true
          schema:
            $ref: '#/definitions/PostPutBuddy'
      tags:
        - Buddy
      responses:
        '201':
          description: The created buddy
          schema:
            $ref: '#/definitions/Buddy'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    get:
      summary: Get all buddies
      description: Fetches all buddies of the user with the given ID
      tags:
        - Buddy
      responses:
        '200':
          description: All buddies of this user.
          schema:
            type: array
            items:
              $ref: '#/definitions/Buddy'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/buddies/{buddyID}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: buddyID
        in: path
        description: The ID of the buddy
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get a buddy
      description: Fetches the buddy identified by the given ID
      tags:
        - Buddy
      responses:
        '200':
          description: The requested buddy.
          schema:
            $ref: '#/definitions/Buddy'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    delete:
      summary: Delete buddy
      description: Deletes this buddy
      tags:
        - Buddy
      responses:
        '200':
          description: The new buddy is deleted.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/buddies/{buddyID}/goals/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: buddyID
        in: path
        description: The ID of the buddy
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get all goals
      description: Fetches all goals of the buddy with the given ID
      tags:
        - Buddy
      responses:
        '200':
          description: All goals of this user.
          schema:
            type: array
            items:
              $ref: '#/definitions/Goal'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/buddies/{buddyID}/goals/{goalID}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: buddyID
        in: path
        description: The ID of the buddy
        required: true
        type: string
      - name: goalID
        in: path
        description: The ID of the goal
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get a goal
      description: Fetches the goal identified by the given ID
      tags:
        - Buddy
      responses:
        '200':
          description: The requested goal.
          schema:
            $ref: '#/definitions/Goal'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/buddies/{buddyID}/activity/days/{date}/details/{goalID}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: buddyID
        in: path
        description: The ID of the buddy
        required: true
        type: string
      - name: date
        in: path
        description: The date of the day in ISO 8601 format (yyyy-MM-dd)
        required: true
        type: string
      - name: goalID
        in: path
        description: The ID of the goal for which the activity was recorded
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get day activity detail
      description: Get day network and app activity for a specific goal on a specific day
      tags:
        - Activity
      responses:
        '200':
          description: Activity of the buddy for the specific goal on the specific day.
          schema:
            $ref: '#/definitions/DayGoalActivityDetail'
  '/users/{userID}/buddies/{buddyID}/activity/days/{date}/details/{goalID}/messages/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: buddyID
        in: path
        description: The ID of the buddy
        required: true
        type: string
      - name: date
        in: path
        description: The date of the day in ISO 8601 format (yyyy-MM-dd)
        required: true
        type: string
      - name: goalID
        in: path
        description: The ID of the goal for which the activity was recorded
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get messages
      description: Fetches all messages related to this activity
      parameters:
        - name: size
          in: query
          description: The number of elements to be fetched
          required: false
          default: 3
          type: number
        - name: page
          in: query
          description: The page to be fetched
          required: false
          default: 0
          type: number
      tags:
        - Activity
        - Message
      responses:
        '200':
          description: Messages related to this activity.
          schema:
            $ref: '#/definitions/PagedMessages'
    post:
      summary: Post new message
      description: Post a new message on this activity.
      parameters:
        - in: body
          name: body
          description: New message
          required: true
          schema:
            $ref: '#/definitions/PostPutActivityCommentMessage'
      tags:
        - Activity
        - Message
      responses:
        '200':
          description: The posted message
          schema:
            $ref: '#/definitions/Message'
  '/users/{userID}/buddies/{buddyID}/activity/weeks/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: buddyID
        in: path
        description: The ID of the buddy
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get week activity overview
      description: Get network and app activity of the current week, pageable to the weeks before
      parameters:
        - name: size
          in: query
          description: The number of elements to be fetched
          required: false
          default: 2
          type: number
        - name: page
          in: query
          description: The page to be fetched
          required: false
          default: 0
          type: number
      tags:
        - Activity
      responses:
        '200':
          description: Activity of the buddy.
          schema:
            $ref: '#/definitions/PagedWeekActivityOverviews'
  '/users/{userID}/buddies/{buddyID}/activity/weeks/{week}/details/{goalID}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: buddyID
        in: path
        description: The ID of the buddy
        required: true
        type: string
      - name: week
        in: path
        description: The date of the week in ISO 8601 format (YYYY-'W'ww)
        required: true
        type: string
      - name: goalID
        in: path
        description: The ID of the goal for which the activity was recorded
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get week activity detail
      description: Get day network and app activity for a specific goal on a specific week
      tags:
        - Activity
      responses:
        '200':
          description: Activity of the buddy for the specific goal on the specific week.
          schema:
            $ref: '#/definitions/WeekGoalActivityDetail'
  '/users/{userID}/buddies/{buddyID}/activity/weeks/{week}/details/{goalID}/messages/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: buddyID
        in: path
        description: The ID of the buddy
        required: true
        type: string
      - name: week
        in: path
        description: The date of the week in ISO 8601 format (YYYY-'W'ww)
        required: true
        type: string
      - name: goalID
        in: path
        description: The ID of the goal for which the activity was recorded
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get messages
      description: Fetches all messages related to this activity
      parameters:
        - name: size
          in: query
          description: The number of elements to be fetched
          required: false
          default: 3
          type: number
        - name: page
          in: query
          description: The page to be fetched
          required: false
          default: 0
          type: number
      tags:
        - Activity
        - Message
      responses:
        '200':
          description: Messages related to this activity.
          schema:
            $ref: '#/definitions/PagedMessages'
    post:
      summary: Post new message
      description: Post a new message on this activity.
      parameters:
        - in: body
          name: body
          description: New message
          required: true
          schema:
            $ref: '#/definitions/PostPutActivityCommentMessage'
      tags:
        - Activity
        - Message
      responses:
        '200':
          description: The posted message
          schema:
            $ref: '#/definitions/Message'
  '/users/{userID}/messages/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get messages
      description: Fetches all messages of the user with the given ID
      parameters:
        - name: onlyUnreadMessages
          in: query
          description: Pass true to only fetch messages with isRead == false
          required: false
          default: false
          type: boolean
        - name: size
          in: query
          description: The number of elements to be fetched
          required: false
          default: 10
          type: number
        - name: page
          in: query
          description: The page to be fetched
          required: false
          default: 0
          type: number
      tags:
        - Message
      responses:
        '200':
          description: Messages of this user.
          schema:
            $ref: '#/definitions/PagedMessages'
  '/users/{userID}/messages/{messageID}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: messageID
        in: path
        description: The ID of the message
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get a message
      description: Fetches all messages of the user with the given ID
      tags:
        - Message
      responses:
        '200':
          description: The message
          schema:
            $ref: '#/definitions/Message'
    delete:
      summary: Delete a message
      description: Deletes the message with the given ID
      tags:
        - Message
      responses:
        '200':
          description: Messages of this user.
  '/users/{userID}/messages/{messageID}/{messageAction}':
    post:
      summary: Act on a message
      description: Perform the Process action on the message with the given ID
      parameters:
        - name: userID
          in: path
          description: The ID of the user
          required: true
          type: string
        - name: messageID
          in: path
          description: The ID of the message
          required: true
          type: string
        - name: messageAction
          in: path
          description: The action to be performed on the message
          required: true
          type: string
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
        - in: body
          name: body
          description: New user
          required: true
          schema:
            $ref: '#/definitions/MessageAction'
      tags:
        - Message
      responses:
        '201':
          description: The action response
          schema:
            $ref: '#/definitions/MessageAction'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/pinResetRequest/request':
    post:
      summary: Request pin reset confirmation code
      description: Post an empty body to this URL to trigger the generation of a pin reset confirmation code
      parameters:
        - name: userID
          in: path
          description: The ID of the user
          required: true
          type: string
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
      tags:
        - Pin reset
      responses:
        '200':
          description: Request registered successfully
          schema:
            type: object
            properties:
              delay:
                type: string
                description: Delay till the confirmation code will be sent by text message. The format complies with the ISO-8601 duration format (PnDTnHnMn.nS).
                example: P1D
            required:
              - delay
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/pinResetRequest/verify':
    post:
      summary: Verify pin reset confirmation code
      description: Post the pin reset confirmation code here for verification
      parameters:
        - name: userID
          in: path
          description: The ID of the user
          required: true
          type: string
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
        - in: body
          name: body
          description: Message with confirmation code
          required: true
          schema:
            $ref: '#/definitions/ConfirmationCode'
      tags:
        - Pin reset
      responses:
        '200':
          description: Confirmation code correct
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/ConfirmationError'
  '/users/{userID}/pinResetRequest/resend':
    post:
      summary: Request resend of a pin reset confirmation code
      description: Post an empty request to get a new pin reset confirmation code texted to the user
      parameters:
        - name: userID
          in: path
          description: The ID of the user
          required: true
          type: string
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
      tags:
        - Pin reset
      responses:
        '200':
          description: The request is successfully handled
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/pinResetRequest/clear':
    post:
      summary: Clear pin reset confirmation code
      description: Post an empty body to this URL to clear the pin reset confirmation code
      parameters:
        - name: userID
          in: path
          description: The ID of the user
          required: true
          type: string
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
      tags:
        - Pin reset
      responses:
        '200':
          description: Request cleared successfully
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/newDeviceRequests/{mobileNumber}':
    parameters:
      - name: mobileNumber
        in: path
        description: The mobile number of the user
        required: true
        type: string
    put:
      summary: Request to add a new device
      description: This stores an encrypted copy of the users device key on the server, for a limited period of time.
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
        - in: body
          name: body
          description: Message with new device request password. The device password will be encrypted with this temporary password and stored for a limited period of time.
          required: true
          schema:
            type: object
            required:
              - newDeviceRequestPassword
            properties:
              newDeviceRequestPassword:
                type: string
                example: id82rQ
      tags:
        - New device requests
      responses:
        '200':
          description: The new device request is available
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    get:
      summary: Get new device request
      description: If the new device request password is given, the returned resource contains the device password. The app can check the presence of a new device request by omitting the new device request password. In that case, a blank new device request is returned.
      parameters:
        - name: Yona-NewDeviceRequestPassword
          in: header
          description: The temporary password used to encrypt the device key
          required: false
          type: string
      tags:
        - New device requests
      responses:
        '200':
          description: The new device request
          schema:
            $ref: '#/definitions/NewDeviceRequest'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    delete:
      summary: Delete new device request
      description: Deletes the new device request
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
      tags:
        - New device requests
      responses:
        '200':
          description: The new device request is deleted.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/activityCategories/':
    get:
      summary: Get all activity categories
      description: Get the set of defined activity categories
      tags:
        - Activity categories
      responses:
        '200':
          description: The activity categories.
          schema:
            type: array
            items:
              $ref: '#/definitions/ActivityCategory'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/activityCategories/{activityCategoryID}':
    get:
      summary: Get an activity category
      description: Fetches the activity category identified by the given ID
      parameters:
        - name: activityCategoryID
          in: path
          description: The ID of the activity category
          required: true
          type: string
      tags:
        - Activity categories
      responses:
        '200':
          description: The requested activity category.
          schema:
            $ref: '#/definitions/ActivityCategory'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/admin/requestUserOverwrite/':
    post:
      summary: Request user overwrite
      description: Request to overwrite the user account after a device loss
      parameters:
        - name: mobileNumber
          in: query
          description: The mobile number to be overwritten
          required: true
          type: string
      tags:
        - Admin
      responses:
        '200':
          description: The request was successfully created. The confirmation will be texted to the mobile number.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
definitions:
  Curies:
    type: object
    properties:
      curies:
        type: array
        description: A set of curies (Compact URIs). For Yona, there is just one curie.
        items:
          type: object
          properties:
            name:
              type: string
              description: The curie name. The prefix of a curied link will be used to find the curie by name
              example: yona
            href:
              type: string
              description: The URL corresponding to this curie.
              example: http://dev.yona.nu/rels/{rel}
            templated:
              type: string
              format: boolean
              description: Whether this curie is templated (always true for Yona).
              example: true
          required:
            - name
            - href
            - templated
  SelfLink:
    type: object
    properties:
      self:
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Identifies this same resource
    required:
      - self
  EditLink:
    type: object
    properties:
      edit:
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Through this link, this resource can be edited or deleted. Note that this link is not always present. Certain resources can never be edited. Some others can only be edited or deleted in a specific state. Unprocessed messages for example cannot be deleted.
  MessagesLink:
    type: object
    properties:
      "yona:messages":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Refers to the related messages
  RelatedLink:
    type: object
    properties:
      related:
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Refers to a related resource
  NextLink:
    type: object
    properties:
      next:
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Refers to the next page
  PrevLink:
    type: object
    properties:
      prev:
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Refers to the previous page
  FirstLink:
    type: object
    properties:
      first:
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Refers to the first page
  LastLink:
    type: object
    properties:
      last:
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Refers to the last page
  UserLink:
    type: object
    properties:
      "yona:user":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: The related user
  BuddyLink:
    type: object
    properties:
      "yona:buddy":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: The related buddy
  MarkReadLink:
    type: object
    properties:
      "yona:markRead":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Post an empty MessageAction on this link to mark the message as read
  MarkUnreadLink:
    type: object
    properties:
      "yona:markUnread":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Post an empty MessageAction on this link to mark the message as unread
  AcceptLink:
    type: object
    properties:
      "yona:accept":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Post a MessageAction with a message on this link to accept this request
  RejectLink:
    type: object
    properties:
      "yona:reject":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Post a MessageAction with a message on this link to reject this request
  ProcessLink:
    type: object
    properties:
      "yona:process":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Post an empty MessageAction on this link to process this response
  ActivityCategoryLink:
    type: object
    properties:
      "yona:activityCategory":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: The related activity category
  GoalLink:
    type: object
    properties:
      "yona:goal":
        type: object
        properties:
          href:
            type: string
        required:
          - href
        description: The related goal
  OvpnProfileLink:
    type: object
    properties:
      "yona:ovpnProfile":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Link to OVPN profile
  DayDetailsLink:
    type: object
    properties:
      "yona:dayDetails":
        type: object
        properties:
          href:
            type: string
        required:
          - href
        description: Link to the details for this goal on this day
  WeekDetailsLink:
    type: object
    properties:
      "yona:weekDetails":
        type: object
        properties:
          href:
            type: string
        required:
          - href
        description: Link to the details for this goal in this week
  WeeklyActivityReportsLink:
    type: object
    properties:
      "yona:weeklyActivityReports":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Refers to the weekly activity reports
  DailyActivityReportsLink:
    type: object
    properties:
      "yona:dailyActivityReports":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Refers to the daily activity reports
  DailyActivityReportsWithBuddiesLink:
    type: object
    properties:
      "yona:dailyActivityReportsWithBuddies":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Refers to the daily activity reports of the user with their buddies
  AddCommentLink:
    type: object
    properties:
      "yona:addComment":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Post a PostPutActivityCommentMessage to this link to add a comment to this activity
  ReplyLink:
    type: object
    properties:
      "yona:reply":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Post a MessageAction with a message on this link to reply to this message
  RepliedMessageLink:
    type: object
    properties:
      "yona:repliedMessage":
        type: object
        properties:
          href:
            type: string
        required:
          - href
        description: Link to earlier message to which the current one is a reply to
  ThreadHeadLink:
    type: object
    properties:
      "yona:threadHead":
        type: object
        properties:
          href:
            type: string
        required:
          - href
        description: Link to the first message of this thread
  Page:
    type: object
    properties:
      page:
        description: Information about the current page
        properties:
          size:
            type: string
            example: 20
            description: The number of elements on the current page
          totalElements:
            type: string
            description: The total number of elements
            example: 300
          totalPages:
            type: string
            description: The total number of pages
            example: 15
          number:
            type: string
            description: The current page number.
            example: 1
        required:
          - size
          - totalElements
          - totalPages
          - number
  BaseUser:
    type: object
    properties:
      firstName:
        type: string
        description: First name.
        example: Richard
      lastName:
        type: string
        description: Last name.
        example: Quin
      mobileNumber:
        type: string
        description: 'Mobile number, unique among all users.'
        example: "+31612345678"
    required:
    - firstName
    - lastName
    - mobileNumber
  PrivateUserDataNoVPN:
    type: object
    properties:
      nickname:
        type: string
        description: Nickname known among buddies. Private data.
        example: RQ
    required:
    - nickname
  PrivateUserData:
    allOf:
      - $ref: '#/definitions/PrivateUserDataNoVPN'
      - type: object
        properties:
          yonaPassword:
            type: string
            description: The Yona password for subsequent requests
            example: AES:128:YXNkZnNhZGZnMnrp1ORubw==
          vpnProfile:
            $ref: '#/definitions/VPNProfile'
  PostPutUser:
    allOf:
      - $ref: '#/definitions/BaseUser'
      - $ref: '#/definitions/PrivateUserDataNoVPN'
  UserWithPrivateData:
    allOf:
      - $ref: '#/definitions/BaseUser'
      - $ref: '#/definitions/PrivateUserData'
      - type: object
        properties:
          sslRootCertCN:
            type: string
            description: The CN of the SSL root certificate
            example: "smoothwall003.yona"
          creationTime:
            type: string
            format: dateTime
            description: The creation time of this user
            example: 2016-04-26T20:08:55.365+0200
          appLastOpenedDate:
            type: string
            format: date
            description: The date the user last opened the Yona app
            example: 2016-04-26
          lastMonitoredActivityDate:
            type: string
            format: date
            description: The date of the last monitored activity
            example: 2016-04-26
          _embedded:
            type: object
            properties:
              "yona:goals":
                type: object
                description: The goals of this user. Private data.
                properties:
                  _embedded:
                    type: object
                    properties:
                      "yona:goals":
                        type: array
                        items:
                          $ref: "#/definitions/Goal"
                  _links:
                    allOf:
                      - $ref: '#/definitions/SelfLink'
                      - $ref: '#/definitions/EditLink'
              "yona:buddies":
                type: object
                description: The buddies of this user. Private data.
                properties:
                  _embedded:
                    type: object
                    properties:
                      "yona:buddies":
                        type: array
                        items:
                          $ref: "#/definitions/Buddy"
                  _links:
                    allOf:
                      - $ref: '#/definitions/SelfLink'
                      - $ref: '#/definitions/EditLink'
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/WeeklyActivityReportsLink'
              - $ref: '#/definitions/DailyActivityReportsLink'
              - $ref: '#/definitions/DailyActivityReportsWithBuddiesLink'
              - $ref: '#/definitions/MessagesLink'
              - type: object
                properties:
                  "yona:confirmMobileNumber":
                    type: object
                    required:
                      - href
                    properties:
                      href:
                        type: string
                        description: If this link is present, the mobile number of the user must be confirmed by posting the confirmation to this URL.
                  "yona:resendMobileNumberConfirmationCode":
                    type: object
                    required:
                      - href
                    properties:
                      href:
                        type: string
                        description: This link allows requesting a resend of the mobile number confirmation code.
                  "yona:postOpenAppEvent":
                    type: object
                    required:
                      - href
                    properties:
                      href:
                        type: string
                        description: This link allows posting to the server that the Yona app was opened.
                  "yona:requestPinReset":
                    type: object
                    required:
                      - href
                    properties:
                      href:
                        type: string
                        description: This link allows requesting a pin reset confirmation code.
                  "yona:verifyPinReset":
                    type: object
                    required:
                      - href
                    properties:
                      href:
                        type: string
                        description: This link allows verifying the pin reset confirmation code.
                  "yona:resendPinResetConfirmationCode":
                    type: object
                    required:
                      - href
                    properties:
                      href:
                        type: string
                        description: This link allows requesting a resend of a new pin reset confirmation code.
                  "yona:clearPinReset":
                    type: object
                    required:
                      - href
                    properties:
                      href:
                        type: string
                        description: This link allows clearing the pin reset confirmation code.
                  "yona:newDeviceRequest":
                    type: object
                    required:
                      - href
                    properties:
                      href:
                        type: string
                        description: Create, get or delete a "new device request" through this link
                  "yona:appActivity":
                    type: object
                    required:
                      - href
                    properties:
                      href:
                        type: string
                        description: Post new app activity data to this link
                  "yona:sslRootCert":
                    type: object
                    required:
                      - href
                    properties:
                      href:
                        type: string
                        description: Link to SSL root certificate file (available after confirming mobile number)
                  "yona:appleMobileConfig":
                    type: object
                    required:
                      - href
                    properties:
                      href:
                        type: string
                        description: Link to user-specific Apple .mobileconfig file (available after confirming mobile number)
        required:
          - _embedded
          - _links
  UserWithOnlyPublicData:
    allOf:
      - $ref: '#/definitions/BaseUser'
      - type: object
        properties:
          creationTime:
            type: string
            format: dateTime
            description: The creation time of this user
            example: 2016-04-26T20:08:55.365+0200
          appLastOpenedDate:
            type: string
            format: date
            description: The date the user last opened the Yona app
            example: 2016-04-26
          _links:
            allOf:
              - $ref: '#/definitions/SelfLink'
        required:
          - _links
  ConfirmationCode:
    type: object
    properties:
      code:
        type: string
        example: 1234
    required:
      - code
  PostPutGoal:
    type: object
    discriminator: "@type"
    properties:
      "@type":
        type: string
        enum:
        - BudgetGoal
        - TimeZoneGoal
        description: The type of goal
      _links:
        allOf:
          - $ref: '#/definitions/ActivityCategoryLink'
    required:
      - "@type"
      - _links
  BudgetGoal:
    allOf:
      - $ref: '#/definitions/PostPutGoal'
      - type: object
        properties:
          maxDurationMinutes:
            type: integer
            description: The budget (duration) for this goal in minutes
            example: 0
        required:
          - maxDurationMinutes
  TimeZoneGoal:
    allOf:
      - $ref: '#/definitions/PostPutGoal'
      - type: object
        properties:
          zones:
            type: array
            items:
              type: string
              example: "8:00-17:00"
            description: The zones for this goal
          spreadCells:
            type: array
            items:
              type: integer
            description: This property cannot be passed in PUT/POST. An array with indexes of the spread that are within the goal boundaries, used to interpret the spread as defined in the day and week activity. 
        required:
          - zones
  Goal:
    type: object
    discriminator: "@type"
    properties:
      "@type":
        type: string
        enum:
        - BudgetGoal
        - TimeZoneGoal
        description: The type of goal
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/EditLink'
          - $ref: '#/definitions/ActivityCategoryLink'
      creationTime:
        type: string
        format: dateTime
        description: The creation time of this goal
        example: 2016-04-26T20:08:55.365+0200
      historyItem:
        type: boolean
        example: true
        description: Indicates whether the goal is retained for historical reasons only. Such goals should not feature in the user's goal list but should be used when displaying activity information.
    required:
      - "@type"
      - _links
      - creationTime
  VPNProfile:
    type: object
    description: VPN profile. Private data, only available after the mobile number is confirmed.
    properties:
      vpnLoginID:
        type: string
        description: The user ID to log in to the VPN
        example: c4b139c0-53ea-4a19-8b60-a6d526bb2277
      vpnPassword:
        type: string
        description: The password to log in to the VPN
        example: UA1ksZCptapsDRdg1Qrn2bDvKdfl8sDd
      _links:
        allOf:
          - $ref: '#/definitions/OvpnProfileLink'
    required:
      - vpnLoginID
      - vpnPassword
  BuddyStatus:
    type: string
    description: The status of this buddy or buddy connect request
    enum:
    - NOT_REQUESTED
    - REQUESTED
    - ACCEPTED
    - REJECTED
  PostPutBuddyUser:
    allOf:
      - $ref: '#/definitions/BaseUser'
      - type: object
        properties:
          emailAddress:
            type: string
            format: email
            description: E-mail address used to inform the buddy about the new buddy request
            example: richard@quin.net
        required:
          - emailAddress
  BaseBuddy:
    type: object
    properties:
      sendingStatus:
        $ref: '#/definitions/BuddyStatus'
      receivingStatus:
        $ref: '#/definitions/BuddyStatus'
    required:
      - sendingStatus
      - receivingStatus
  PostPutBuddy:
    allOf:
      - $ref: '#/definitions/BaseBuddy'
      - type: object
        properties:
          message:
            type: string
            description: A message to the buddy
            example: Hi there, would you want to become my buddy?
          _embedded:
            type: object
            properties:
              "yona:user":
                  $ref: "#/definitions/PostPutBuddyUser"
            required:
              - "yona:user"
        required:
          - _embedded
  Buddy:
    allOf:
      - $ref: '#/definitions/BaseBuddy'
      - type: object
        properties:
          nickname:
            type: string
            description: The nickname of the buddy
            example: RQ
          lastStatusChangeTime:
            type: string
            format: dateTime
            description: The time of the last status change (request/accept/reject) of this buddy
            example: 2016-02-23T21:28:58.556+0000
          lastMonitoredActivityDate:
            type: string
            format: date
            description: The date of the last monitored activity of this buddy
            example: 2016-04-26
          _embedded:
            type: object
            properties:
              "yona:goals":
                type: object
                description: The goals of this buddy.
                properties:
                  _embedded:
                    type: object
                    properties:
                      "yona:goals":
                        type: array
                        items:
                          $ref: "#/definitions/Goal"
                  _links:
                    allOf:
                      - $ref: '#/definitions/SelfLink'
              "yona:user":
                  $ref: "#/definitions/UserWithOnlyPublicData"
            required:
              - "yona:user"
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/WeeklyActivityReportsLink'
              - $ref: '#/definitions/DailyActivityReportsLink'
        required:
          - lastStatusChangeTime
          - _embedded
          - _links
  NewDeviceRequest:
    type: object
    properties:
      yonaPassword:
        type: string
        description: The Yona password used to encrypt this account. If the new device request password was not provided in the request, this property will be blank.
        example: Gl3BHx6AaTPVHlNNb1HF
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/EditLink'
          - $ref: '#/definitions/UserLink'
    required:
      - yonaPassword
      - _links
  ActivityCategory:
    type: object
    properties:
      name:
        type: string
        description: The name of this activity category
        example: Gambling
      applications:
        type: array
        items:
          type: string
        description: The set of apps linked to this activity category
        example:
          - Roulette
          - Blackjack
      description:
        type: string
        description: The desription of this activity category
        example: This challenge includes apps and sites like Poker and Blackjack
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
    required:
      - name
      - applications
      - _links
  Message:
    type: object
    discriminator: "@type"
    properties:
      "@type":
        type: string
        enum:
        - BuddyConnectRequestMessage
        - BuddyConnectResponseMessage
        - BuddyDisconnectMessage
        - BuddyInfoChangeMessage
        - GoalConflictMessage
        - GoalChangeMessage
        - DisclosureRequestMessage
        - DisclosureResponseMessage
        - ActivityCommentMessage
        - SystemMessage
      creationTime:
        type: string
        format: dateTime
        description: The creation time of this message
        example: 2016-02-23T21:28:58.556+0000
      isRead:
        type: boolean
        format: dateTime
        description: When true, the app has marked this message as read.
        example: false
    required:
      - "@type"
      - creationTime
  SystemMessage:
    allOf:
      - $ref: '#/definitions/Message'
      - type: object
        properties:
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/MarkReadLink'
              - $ref: '#/definitions/MarkUnreadLink'
          message:
            type: string
            description: The message from the system administrator
            example: On Monday, 7th of November from 12am-6am UTC we will restart our servers. You will not be able to use the Yona app in this window.
        required:
          - _links
          - message      
  BuddyMessage:
    allOf:
      - $ref: '#/definitions/Message'
      - type: object
        properties:
          nickname:
            type: string
            description: The nickname of the buddy
            example: RQ
          message:
            type: string
            description: The message from the buddy
            example: Hi there, how are you doing?
        required:
          - nickname
          - message
  BuddyMessageWithEmbeddedUser:
    allOf:
      - $ref: '#/definitions/BuddyMessage'
      - type: object
        properties:
          _embedded:
            type: object
            properties:
              "yona:user":
                  $ref: "#/definitions/UserWithOnlyPublicData"
            required:
              - "yona:user"
  BuddyConnectRequestMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessageWithEmbeddedUser'
      - type: object
        properties:
          status:
            $ref: '#/definitions/BuddyStatus'
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/MarkReadLink'
              - $ref: '#/definitions/MarkUnreadLink'
              - $ref: '#/definitions/AcceptLink'
              - $ref: '#/definitions/RejectLink'
        required:
          - status
          - _links
  BuddyConnectResponseMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessage'
      - type: object
        properties:
          status:
            $ref: '#/definitions/BuddyStatus'
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/UserLink'
              - $ref: '#/definitions/BuddyLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/MarkReadLink'
              - $ref: '#/definitions/MarkUnreadLink'
              - $ref: '#/definitions/ProcessLink'
        required:
          - status
          - _links
  BuddyDisconnectMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessageWithEmbeddedUser'
      - type: object
        properties:
          dropBuddyReason:
            type: string
            enum:
              - USER_ACCOUNT_DELETED
              - USER_REMOVED_BUDDY
            description: The reason why this buddy is disconnected
            example: USER_REMOVED_BUDDY
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/MarkReadLink'
              - $ref: '#/definitions/MarkUnreadLink'
              - $ref: '#/definitions/ProcessLink'
        required:
          - dropBuddyReason
          - _links
  BuddyInfoChangeMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessage'
      - type: object
        properties:
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/UserLink'
              - $ref: '#/definitions/BuddyLink'
              - $ref: '#/definitions/MarkReadLink'
              - $ref: '#/definitions/MarkUnreadLink'
              - $ref: '#/definitions/ProcessLink'
        required:
          - _links
  GoalConflictStatus:
    type: string
    description: The status of this goal conflict message or disclosure request
    enum:
    - ANNOUNCED
    - DISCLOSURE_REQUESTED
    - DISCLOSURE_ACCEPTED
    - DISCLOSURE_REJECTED
  GoalChange:
    type: string
    description: The change applied to a goal
    enum:
    - GOAL_ADDED
    - GOAL_CHANGED
    - GOAL_DELETED
  GoalConflictMessage:
    allOf:
      - $ref: '#/definitions/Message'
      - type: object
        properties:
          nickname:
            type: string
            description: The nickname of the buddy
            example: RQ
          status:
            $ref: '#/definitions/GoalConflictStatus'
          url:
            type: string
            description: The URL on which the goal conflict was detected
            example: http://www.poker.com
          activityStartTime:
            type: string
            format: dateTime
            description: The start time of this activity
            example: 2016-02-31T21:03:52.290+0000
          activityEndTime:
            type: string
            format: dateTime
            description: The end time of this activity
            example: 2016-02-31T21:03:57.721+0000
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/MarkReadLink'
              - $ref: '#/definitions/MarkUnreadLink'
              - $ref: '#/definitions/BuddyLink'
              - $ref: '#/definitions/ActivityCategoryLink'
              - $ref: '#/definitions/DayDetailsLink'
            properties:
              "yona:requestDisclosure":
                properties:
                  href:
                    type: string
                    description: Post a MessageAction with a message property to accept this disclosure request
        required:
          - nickname
          - status
          - url
          - activityStartTime
          - activityEndTime
          - _links
  GoalChangeMessage:
    allOf:
      - $ref: '#/definitions/Message'
      - type: object
        properties:
          change:
            $ref: '#/definitions/GoalChange'
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/ActivityCategoryLink'
              - $ref: '#/definitions/BuddyLink'
        required:
          - change
          - _links
  DisclosureRequestMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessage'
      - type: object
        properties:
          status:
            $ref: '#/definitions/GoalConflictStatus'
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/UserLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/MarkReadLink'
              - $ref: '#/definitions/MarkUnreadLink'
              - $ref: '#/definitions/RelatedLink'
              - $ref: '#/definitions/AcceptLink'
              - $ref: '#/definitions/RejectLink'
              - $ref: '#/definitions/DayDetailsLink'
        required:
          - status
          - _links
  DisclosureResponseMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessage'
      - type: object
        properties:
          status:
            $ref: '#/definitions/GoalConflictStatus'
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/UserLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/MarkReadLink'
              - $ref: '#/definitions/MarkUnreadLink'
              - $ref: '#/definitions/RelatedLink'
              - $ref: '#/definitions/DayDetailsLink'
        required:
          - status
          - _links
  ActivityCommentMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessage'
      - type: object
        properties:
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/UserLink'
              - $ref: '#/definitions/BuddyLink'
              - $ref: '#/definitions/EditLink'
              - $ref: '#/definitions/MarkReadLink'
              - $ref: '#/definitions/MarkUnreadLink'
              - $ref: '#/definitions/DayDetailsLink'
              - $ref: '#/definitions/WeekDetailsLink'
              - $ref: '#/definitions/ReplyLink'
              - $ref: '#/definitions/RepliedMessageLink'
              - $ref: '#/definitions/ThreadHeadLink'
        required:
          - _links
  PostPutActivityCommentMessage:
    type: object
    properties:
      message:
        type: string
        description: The message from the buddy
        example: Good job!
    required:
      - message
  PagedWeekActivityOverviews:
    allOf:
      - $ref: '#/definitions/Page'
      - type: object
        properties:
          _embedded:
            properties:
              "yona:weekActivityOverviews":
                type: array
                items:
                  $ref: '#/definitions/WeekActivityOverview'
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/NextLink'
              - $ref: '#/definitions/PrevLink'
              - $ref: '#/definitions/FirstLink'
              - $ref: '#/definitions/LastLink'
            required:
              - self
        required:
          - _links
          - _embedded
          - page
  WeekActivityOverview:
    type: object
    properties:
      date:
        type: string
        example: 2016-W02
        description: The week date in ISO 8601 format (2016-W02)
      timeZoneId:
        type: string
        description: The time zone identifier that the user had configured when this week started.
        example: Europe/Amsterdam
      weekActivities:
        type: array
        items:
          $ref: '#/definitions/WeekGoalActivityOverview'
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
        description: The self link is currently not returned from the server. See YD-203
    required:
      - _links
      - date
      - timeZoneId
      - weekActivities
  WeekGoalActivityOverview:
    type: object
    properties:
      dayActivities:
        properties:
          SUNDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          MONDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          TUESDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          WEDNESDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          THURSDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          FRIDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          SATURDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
      _links:
        allOf:
          - $ref: '#/definitions/GoalLink'
          - $ref: '#/definitions/WeekDetailsLink'
        required:
          - "yona:goal"
          - "yona:weekDetails"
  WeekGoalActivityDetail:
    type: object
    properties:
      date:
        type: string
        example: 2016-W02
        description: The week date in ISO 8601 format (YYYY-'W'ww).
      timeZoneId:
        type: string
        description: The time zone identifier that the user had configured when this week started.
        example: Europe/Amsterdam
      spread:
        type: array
        items:
          type: integer
        description: Aggregates all activity on every quarter hour of the day (of which there are 96) taking the average for all days in the week.
      totalActivityDurationMinutes:
        type: integer
        description: Total minutes spent on the activity category during this week.
      dayActivities:
        properties:
          SUNDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          MONDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          TUESDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          WEDNESDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          THURSDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          FRIDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
          SATURDAY:
              $ref: '#/definitions/DayGoalActivityInWeek'
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/GoalLink'
          - $ref: '#/definitions/AddCommentLink'
          - $ref: '#/definitions/MessagesLink'
          - $ref: '#/definitions/PrevLink'
          - $ref: '#/definitions/NextLink'
    required:
      - date
      - timeZoneId
      - spread
      - totalActivityDurationMinutes
      - _links
  PagedDayActivityOverviews:
    allOf:
      - $ref: '#/definitions/Page'
      - type: object
        properties:
          _embedded:
            properties:
              "yona:dayActivityOverviews":
                type: array
                items:
                  $ref: '#/definitions/DayActivityOverview'
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/NextLink'
              - $ref: '#/definitions/PrevLink'
              - $ref: '#/definitions/FirstLink'
              - $ref: '#/definitions/LastLink'
            required:
              - curies
              - self
        required:
          - _embedded
          - page
          - _links
  DayActivityOverview:
    type: object
    properties:
      date:
        type: string
        format: date
        example: 2016-03-16
        description: The day date in ISO 8601 format (yyyy-MM-dd)
      timeZoneId:
        type: string
        description: The time zone identifier that the user had configured when this day started.
        example: Europe/Amsterdam
      dayActivities:
        type: array
        items:
          $ref: '#/definitions/DayGoalActivityOverview'
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
        description: The self link is currently not returned from the server. See YD-203
    required:
      - date
      - dayActivities
      - _links
  DayGoalActivityBase:
    type: object
    properties:
      totalActivityDurationMinutes:
        type: integer
        example: 20
        description: Total minutes spent on the activity category during this day.
      goalAccomplished:
        type: boolean
        example: true
        description: If the goal for this day was accomplished. If the day is not yet over, if the goal for this day was accomplished so far.
      totalMinutesBeyondGoal:
        type: integer
        example: 0
        description: The total minutes of time the user was active in the activity category outside the allowed time for the goal.
    required:
      - totalActivityDurationMinutes
      - goalAccomplished
      - totalMinutesBeyondGoal
  DayGoalActivityInWeek:
    allOf:
      - $ref: '#/definitions/DayGoalActivityBase'
      - type: object
        properties:
          _links:
            allOf:
              - $ref: '#/definitions/DayDetailsLink'
            required:
              - "yona:dayDetails"
        required:
          - _links
  DayGoalActivityOverview:
    allOf:
      - $ref: '#/definitions/DayGoalActivityBase'
      - type: object
        properties:
          spread:
            type: array
            items:
              type: integer
            description: Aggregates all activity on every quarter hour of the day (of which there are 96). This information is only included for time zone goals.
          _links:
            allOf:
              - $ref: '#/definitions/GoalLink'
              - $ref: '#/definitions/DayDetailsLink'
            required:
              - "yona:goal"
              - "yona:dayDetails"
        required:
          - _links
  DayGoalActivityDetail:
    allOf:
      - $ref: '#/definitions/DayGoalActivityBase'
      - type: object
        properties:
          date:
            type: string
            example: 2016-03-16
            description: The day date in ISO 8601 format (yyyy-MM-dd).
          timeZoneId:
            type: string
            description: The time zone identifier that the user had configured when this day started.
            example: Europe/Amsterdam
          spread:
            type: array
            items:
              type: integer
            description: Aggregates all activity on every quarter hour of the day (of which there are 96).
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/GoalLink'
              - $ref: '#/definitions/AddCommentLink'
              - $ref: '#/definitions/MessagesLink'
              - $ref: '#/definitions/PrevLink'
              - $ref: '#/definitions/NextLink'
            required:
              - self
              - "yona:goal"
          # TODO: embedded messages
        required:
          - date
          - timeZoneId
          - totalActivityDurationMinutes
          - goalAccomplished
          - totalMinutesBeyondGoal
          - _links
  PagedDayActivityOverviewsWithBuddies:
    allOf:
      - $ref: '#/definitions/Page'
      - type: object
        properties:
          _embedded:
            properties:
              "yona:dayActivityOverviews":
                type: array
                items:
                  $ref: '#/definitions/DayActivityOverviewWithBuddies'
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/NextLink'
              - $ref: '#/definitions/PrevLink'
              - $ref: '#/definitions/FirstLink'
              - $ref: '#/definitions/LastLink'
            required:
              - curies
              - self
        required:
          - _embedded
          - page
          - _links
  DayActivityOverviewWithBuddies:
    type: object
    properties:
      date:
        type: string
        format: date
        example: 2016-03-16
        description: The day date in ISO 8601 format (yyyy-MM-dd)
      timeZoneId:
        type: string
        description: The time zone identifier that the user had configured when this day started.
        example: Europe/Amsterdam
      dayActivities:
        type: array
        items:
          $ref: '#/definitions/DayGoalActivityOverviewWithBuddies'
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
        description: The self link is currently not returned from the server. See YD-203
    required:
      - date
      - dayActivities
      - _links
  DayGoalActivityOverviewWithBuddies:
    type: object
    properties:
      dayActivitiesForUsers:
        type: array
        items:
          $ref: '#/definitions/DayGoalActivityOverviewForUser'
      _links:
        allOf:
          - $ref: '#/definitions/ActivityCategoryLink'
        required:
          - "yona:activityCategory"
    required:
      - _links
  DayGoalActivityOverviewForUser:
    allOf:
      - $ref: '#/definitions/DayGoalActivityBase'
      - type: object
        properties:
          spread:
            type: array
            items:
              type: integer
            description: Aggregates all activity on every quarter hour of the day (of which there are 96). This information is only included for time zone goals.
          _links:
            allOf:
              - $ref: '#/definitions/GoalLink'
              - $ref: '#/definitions/DayDetailsLink'
              - $ref: '#/definitions/UserLink'
              - $ref: '#/definitions/BuddyLink'
            required:
              - "yona:goal"
              - "yona:dayDetails"
              - "yona:user"
        required:
          - _links
  PagedMessages:
    allOf:
      - $ref: '#/definitions/Page'
      - type: object
        properties:
          _links:
            allOf:
              - $ref: '#/definitions/Curies'
              - $ref: '#/definitions/SelfLink'
              - $ref: '#/definitions/NextLink'
              - $ref: '#/definitions/PrevLink'
              - $ref: '#/definitions/FirstLink'
              - $ref: '#/definitions/LastLink'
            required:
              - self
          _embedded:
            properties:
              "yona:messages":
                type: array
                items:
                  $ref: '#/definitions/Message'
        required:
          - _links
          - _embedded
          - page
  MessageAction:
    type: object
    properties:
      "properties":
        type: object
        description: A set of properties to be passed to the message action
        additionalProperties:
          type: string
    required:
      - "properties"
  Error:
    type: object
    properties:
      code:
        type: string
        description: The error code
        example: error.user.mobile.number.invalid
      message:
        type: string
        description: A localized error message
        example: The mobile number ''+31 6 12345678'' is invalid. It must start with a + sign, with no spaces between the digits
  ConfirmationError:
    allOf:
      - $ref: '#/definitions/Error'
      - type: object
        properties:
          remainingAttempts:
            type: integer
            description: The number of remaining attempts. Only available upon a failed confirmation attempt
            example: 4